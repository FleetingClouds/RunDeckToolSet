- id: net.fleetingclouds.initial.prepHost
  project: PrepareGenericVPS
  loglevel: INFO
  sequence:
    keepgoing: false
    strategy: node-first
    commands:
    - exec: echo " . . . .  . . . .  . . . . Run First Step  . . . .  . . . .  . . . .  . . . . "
    - jobref:
        group: net/fleetingclouds/initial
        name: Push RunDeck public key to host
        args: -FingerPrint ${option.FingerPrint} -Host ${option.Host} -Password ${option.Password} -User ${option.User}
    - exec: echo " . . . .  . . . .  . . . . Run Second Step  . . . .  . . . .  . . . .  . . . . "
    - jobref:
        group: net/fleetingclouds/initial
        name: CreateAdminUsers
        args: -Host ${option.Host} -User ${option.User}
    - exec: echo " . . . .  . . . .  . . . . Finished  . . . .  . . . .  . . . .  . . . . "
    - script: |
        echo "*******************************************************************"
        echo "****"
        echo "**** You must now connect, as the *rundeck* user, to $RD_OPTION_HOST "
        echo "**** in order to change the password 'okokok' to a real one. "
        echo "****"
        echo "**** Use :"
        echo "****   - sudo -sHu rundeck"
        echo "****   - ssh $RD_OPTION_HOST"
        echo "****"
        echo "*******************************************************************"
  description: Calls Steps One & Two
  name: PrepareHost
  uuid: net.fleetingclouds.initial.prepHost
  group: net/fleetingclouds/initial
  options:
    FingerPrint:
      required: true
      description: This is the SSH fingerprint that RunDeck must expect for all future connections to the indicated host.
      value: 95:aa:d1:17:ed:68:c9:25:be:e7:8a:fc:cf:c7:ac:c3
    Host:
      required: true
      description: This is a host that RunDeck will be accessing in the future.
      value: www.fleetingclouds.net
    Password:
      required: true
      description: This is the root password for the indicated host.  It should be used just this one time, and never again.
      value: Hbr91NGi3J6qhob5lXht
    User:
      required: true
      description: 'The user authorized to do this : ${option.User}'
      value: root
