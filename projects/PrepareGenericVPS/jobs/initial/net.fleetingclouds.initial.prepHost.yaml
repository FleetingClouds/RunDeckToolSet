- id: net.fleetingclouds.initial.prepHost
  project: PrepareGenericVPS
  loglevel: INFO
  sequence:
    keepgoing: false
    strategy: node-first
    commands:
    - exec: echo " . . . .  . . . .  . . . . Run First Step  . . . .  . . . .  . . . .  . . . . "
    - jobref:
        group: net/fleetingclouds/initial
        name: Push RunDeck public key to host
        args: -FingerPrint ${option.FingerPrint} -Host ${option.Host} -Password ${option.Password}
    - exec: echo " . . . .  . . . .  . . . . Run Second Step  . . . .  . . . .  . . . .  . . . . "
    - jobref:
        group: net/fleetingclouds/initial
        name: CreateAdminUsers
        args: -Host ${option.Host}
    - exec: echo " . . . .  . . . .  . . . . Finished  . . . .  . . . .  . . . .  . . . . "
    - script: |
        echo "*******************************************************************"
        echo "****"
        echo "**** You must now connect, as the *rundeck* user, to $RD_OPTION_HOST "
        echo "**** in order to change the password 'okokok' to a real one. "
        echo "****"
        echo "**** Use :"
        echo "****   - sudo -sHu rundeck"
        echo "****   - ssh $RD_OPTION_HOST"
        echo "****"
        echo "*******************************************************************"
  description: Calls Steps One & Two
  name: PrepareHost
  uuid: net.fleetingclouds.initial.prepHost
  group: net/fleetingclouds/initial
  options:
    FingerPrint:
      required: true
      description: This is the SSH fingerprint that RunDeck must expect for all future connections to the indicated host.
      value: 2d:80:62:88:3f:1f:80:54:2e:37:fb:8b:f1:42:e6:9e
    Host:
      required: true
      description: This is a host that RunDeck will be accessing in the future.
      value: www.fleetingclouds.net
    Password:
      required: true
      description: This is the root password for the indicated host.  It should be used just this one time, and never again.
      value: grJP4hsYRa71ctgCw01g
