- id: net.fleetingclouds.install.chef.bootstrap
  project: PrepareGenericVPS
  loglevel: INFO
  sequence:
    keepgoing: false
    strategy: node-first
    commands:
    - exec: echo "Preparing Chef client ............................................."
    - exec: sudo pwd
    - exec: echo "Register OpsCode as apt repo. . . . . . . . . . . . . "
    - exec: echo "deb http://apt.opscode.com/ `lsb_release -cs`-0.10 main" | tee ./opscode.list
    - exec: sudo mv opscode.list /etc/apt/sources.list.d/
    - exec: echo "Get its GPG key . . . . . . . . . . . . . . . . . . . "
    - exec: ' gpg --keyserver keys.gnupg.net --recv-keys 83EF826A'
    - exec: echo "Get packages key ring. . . . . . . . . . . . . . . . . . . . . "
    - exec: gpg --export packages@opscode.com | tee ./opscode-keyring.gpg
    - exec: sudo mkdir -p /etc/apt/trusted.gpg.d/
    - exec: sudo mv ./opscode-keyring.gpg /etc/apt/trusted.gpg.d/
    - exec: echo "Done preparing Chef hostname ................................................."
    - exec: echo ". . . . . . . . . . . . . . . . . . . . . . . . . . . . "
  description: From a properly configured Chef workstation this sends across the bootstrap scripts to the client,.
  name: BootstrapClient
  uuid: net.fleetingclouds.install.chef.bootstrap
  nodefilters:
    dispatch:
      threadcount: 1
      keepgoing: false
      excludePrecedence: true
      rankOrder: ascending
    include:
      name: gate.*
  group: net/fleetingclouds/install/chef
  options:
    sudoPwdRunDeck:
      required: true
      description: Chef's password.
      value: okmmpl,,
      secure: true
